abline(lm(surv.time ~ test.temp,data = m.28198),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28247),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28248),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28258),col="gray")
abline(lm(surv.time ~ test.temp,data = m.29652),col="gray")
abline(lm(surv.time ~ test.temp,data = data_m),col="#A6761D",lwd=3)
#update axis
axis(2, at=xs, labels=labs, cex.axis=1.2)
par(mai=c(0.55,0.6,0,0.1))
plot(sort(m1$Stime_resc),rev(100*(1:length(m1$Stime_resc)-1)/(length(m1$Stime_resc)-1)),
col="gray",type="l",ylab="Survival probability",xlab="Time (min)",cex.axis=1.2, cex.lab=1.4,las=1,xlim=c(0,110))
points(sort(m2$Stime_resc),rev(100*(1:length(m2$Stime_resc)-1)/(length(m2$Stime_resc)-1)),col="gray",type="l")
points(sort(m3$Stime_resc),rev(100*(1:length(m3$Stime_resc)-1)/(length(m3$Stime_resc)-1)),col="gray",type="l")
points(sort(m4$Stime_resc),rev(100*(1:length(m4$Stime_resc)-1)/(length(m4$Stime_resc)-1)),col="gray",type="l")
points(sort(m5$Stime_resc),rev(100*(1:length(m5$Stime_resc)-1)/(length(m5$Stime_resc)-1)),col="gray",type="l")
points(sort(m6$Stime_resc),rev(100*(1:length(m6$Stime_resc)-1)/(length(m6$Stime_resc)-1)),col="gray",type="l")
points(sort(m7$Stime_resc),rev(100*(1:length(m7$Stime_resc)-1)/(length(m7$Stime_resc)-1)),col="gray",type="l")
points(sort(m8$Stime_resc),rev(100*(1:length(m8$Stime_resc)-1)/(length(m8$Stime_resc)-1)),col="gray",type="l")
points(sort(m9$Stime_resc),rev(100*(1:length(m9$Stime_resc)-1)/(length(m9$Stime_resc)-1)),col="gray",type="l")
points(sort(m10$Stime_resc),rev(100*(1:length(m10$Stime_resc)-1)/(length(m10$Stime_resc)-1)),col="gray",type="l")
points(sort(m11$Stime_resc),rev(100*(1:length(m11$Stime_resc)-1)/(length(m11$Stime_resc)-1)),col="gray",type="l")
points(sort(m12$Stime_resc),rev(100*(1:length(m12$Stime_resc)-1)/(length(m12$Stime_resc)-1)),col="gray",type="l")
points(sort(m13$Stime_resc),rev(100*(1:length(m13$Stime_resc)-1)/(length(m13$Stime_resc)-1)),col="gray",type="l")
points(sort(m14$Stime_resc),rev(100*(1:length(m14$Stime_resc)-1)/(length(m14$Stime_resc)-1)),col="gray",type="l")
points(sort(m15$Stime_resc),rev(100*(1:length(m15$Stime_resc)-1)/(length(m15$Stime_resc)-1)),col="gray",type="l")
points(sort(m16$Stime_resc),rev(100*(1:length(m16$Stime_resc)-1)/(length(m16$Stime_resc)-1)),col="gray",type="l")
points(sort(m17$Stime_resc),rev(100*(1:length(m17$Stime_resc)-1)/(length(m17$Stime_resc)-1)),col="gray",type="l")
points(sort(m18$Stime_resc),rev(100*(1:length(m18$Stime_resc)-1)/(length(m18$Stime_resc)-1)),col="gray",type="l")
points(sort(m19$Stime_resc),rev(100*(1:length(m19$Stime_resc)-1)/(length(m19$Stime_resc)-1)),col="gray",type="l")
points(sort(m20$Stime_resc),rev(100*(1:length(m20$Stime_resc)-1)/(length(m20$Stime_resc)-1)),col="gray",type="l")
points(sort(mall$Stime_resc),rev(100*(1:length(mall$Stime_resc)-1)/(length(mall$Stime_resc)-1)),col="#A6761D",lwd=3,type="l")
text(70,92,"Inbred lines",col="gray",adj=0,font=2,cex=1.2)
text(70,85,"Pooled lines",adj=0,col="#A6761D",font=2,cex=1.2)
# close device
dev.off()
}
#-------------------------------------------------------------------------------
# FIGURE 1
#-------------------------------------------------------------------------------
{
pdf("../Outputs/1.2.1. Figure 1 Survival probabilities of DGRP lines.pdf",width = 6,height = 8,useDingbats = FALSE)
#png("../Outputs/1.2.1. Figure 1 Survival probabilities of DGRP lines.png",width = 6,height = 8,units = "in",res = 600)
par(mfrow=c(3,2),tcl=-0.4, family="serif",omi=c(0,0,0,0))
#Sexes pooled
# labels
labs= c("1","2","5","10","30","120","420")
xs= log10(c(1,2,5,10,30,60*2,60*7))
par(mai=c(0.55,0.6,0.1,0.1))
#TDT plots
plot(surv.time ~ jitter(test.temp,0.5),xlim=c(35.6,39.4),ylim=c(0,3),cex.axis=1.2,
cex.lab=1.4,yaxt="n",cex=1.4,pch=16,col="#55555540",xlab="",ylab="",data=p.25180)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.25182)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.25190)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.25192)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.25198)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.25201)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.25203)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28135)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28141)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28153)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28173)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28180)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28191)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28196)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28197)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28198)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28247)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28248)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28258)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.29652)
abline(lm(surv.time ~ test.temp,data = p.25180),col="gray")
abline(lm(surv.time ~ test.temp,data = p.25182),col="gray")
abline(lm(surv.time ~ test.temp,data = p.25190),col="gray")
abline(lm(surv.time ~ test.temp,data = p.25192),col="gray")
abline(lm(surv.time ~ test.temp,data = p.25198),col="gray")
abline(lm(surv.time ~ test.temp,data = p.25201),col="gray")
abline(lm(surv.time ~ test.temp,data = p.25203),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28135),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28141),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28153),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28173),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28180),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28191),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28196),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28197),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28198),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28247),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28248),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28258),col="gray")
abline(lm(surv.time ~ test.temp,data = p.29652),col="gray")
abline(lm(surv.time ~ test.temp,data = all.lines.21),col="#555555",lwd=3)
#update axis
axis(2, at=xs, labels=labs, cex.axis=1.2)
#survival plots
par(mai=c(0.55,0.6,0.1,0.1))
plot(sort(p1$Stime_resc),rev(100*(1:length(p1$Stime_resc)-1)/(length(p1$Stime_resc)-1)),
col="gray",type="l",ylab="Survival probability",xlab="",cex.axis=1.2, cex.lab=1.4,las=1,xlim=c(0,110))
points(sort(p2$Stime_resc),rev(100*(1:length(p2$Stime_resc)-1)/(length(p2$Stime_resc)-1)),col="gray",type="l")
points(sort(p3$Stime_resc),rev(100*(1:length(p3$Stime_resc)-1)/(length(p3$Stime_resc)-1)),col="gray",type="l")
points(sort(p4$Stime_resc),rev(100*(1:length(p4$Stime_resc)-1)/(length(p4$Stime_resc)-1)),col="gray",type="l")
points(sort(p5$Stime_resc),rev(100*(1:length(p5$Stime_resc)-1)/(length(p5$Stime_resc)-1)),col="gray",type="l")
points(sort(p6$Stime_resc),rev(100*(1:length(p6$Stime_resc)-1)/(length(p6$Stime_resc)-1)),col="gray",type="l")
points(sort(p7$Stime_resc),rev(100*(1:length(p7$Stime_resc)-1)/(length(p7$Stime_resc)-1)),col="gray",type="l")
points(sort(p8$Stime_resc),rev(100*(1:length(p8$Stime_resc)-1)/(length(p8$Stime_resc)-1)),col="gray",type="l")
points(sort(p9$Stime_resc),rev(100*(1:length(p9$Stime_resc)-1)/(length(p9$Stime_resc)-1)),col="gray",type="l")
points(sort(p10$Stime_resc),rev(100*(1:length(p10$Stime_resc)-1)/(length(p10$Stime_resc)-1)),col="gray",type="l")
points(sort(p11$Stime_resc),rev(100*(1:length(p11$Stime_resc)-1)/(length(p11$Stime_resc)-1)),col="gray",type="l")
points(sort(p12$Stime_resc),rev(100*(1:length(p12$Stime_resc)-1)/(length(p12$Stime_resc)-1)),col="gray",type="l")
points(sort(p13$Stime_resc),rev(100*(1:length(p13$Stime_resc)-1)/(length(p13$Stime_resc)-1)),col="gray",type="l")
points(sort(p14$Stime_resc),rev(100*(1:length(p14$Stime_resc)-1)/(length(p14$Stime_resc)-1)),col="gray",type="l")
points(sort(p15$Stime_resc),rev(100*(1:length(p15$Stime_resc)-1)/(length(p15$Stime_resc)-1)),col="gray",type="l")
points(sort(p16$Stime_resc),rev(100*(1:length(p16$Stime_resc)-1)/(length(p16$Stime_resc)-1)),col="gray",type="l")
points(sort(p17$Stime_resc),rev(100*(1:length(p17$Stime_resc)-1)/(length(p17$Stime_resc)-1)),col="gray",type="l")
points(sort(p18$Stime_resc),rev(100*(1:length(p18$Stime_resc)-1)/(length(p18$Stime_resc)-1)),col="gray",type="l")
points(sort(p19$Stime_resc),rev(100*(1:length(p19$Stime_resc)-1)/(length(p19$Stime_resc)-1)),col="gray",type="l")
points(sort(p20$Stime_resc),rev(100*(1:length(p20$Stime_resc)-1)/(length(p20$Stime_resc)-1)),col="gray",type="l")
points(sort(pall$Stime_resc),rev(100*(1:length(pall$Stime_resc)-1)/(length(pall$Stime_resc)-1)),col="#555555",lwd=3,type="l")
text(70,92,"Inbred lines",col="gray",adj=0,font=2,cex=1.2)
text(70,85,"Pooled lines",adj=0,col="#555555",font=2,cex=1.2)
#-----------------------------------------------------------------------------
#females
# labels
labs= c("1","2","5","10","30","120","420")
xs= log10(c(1,2,5,10,30,60*2,60*7))
#TDT curves
par(mai=c(0.55,0.6,0,0.1))
plot(surv.time ~ jitter(test.temp,0.5),xlim=c(35.6,39.4),ylim=c(0,3),cex.axis=1.2, cex.lab=1.4,yaxt="n",cex=1.4,pch=16,
col="#4DAC2660",xlab="",ylab="",data=f.25180)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.25182)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.25190)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.25192)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.25198)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.25201)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.25203)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28135)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28141)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28153)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28173)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28180)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28191)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28196)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28197)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28198)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28247)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28248)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28258)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.29652)
abline(lm(surv.time ~ test.temp,data = f.25180),col="gray")
abline(lm(surv.time ~ test.temp,data = f.25182),col="gray")
abline(lm(surv.time ~ test.temp,data = f.25190),col="gray")
abline(lm(surv.time ~ test.temp,data = f.25192),col="gray")
abline(lm(surv.time ~ test.temp,data = f.25198),col="gray")
abline(lm(surv.time ~ test.temp,data = f.25201),col="gray")
abline(lm(surv.time ~ test.temp,data = f.25203),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28135),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28141),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28153),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28173),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28180),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28191),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28196),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28197),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28198),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28247),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28248),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28258),col="gray")
abline(lm(surv.time ~ test.temp,data = f.29652),col="gray")
abline(lm(surv.time ~ test.temp,data = data_f),col="#4DAC26",lwd=3)
#update axis
axis(2, at=xs, labels=labs, cex.axis=1.2)
par(mai=c(0.55,0.6,0,0.1))
plot(sort(f1$Stime_resc),rev(100*(1:length(f1$Stime_resc)-1)/(length(f1$Stime_resc)-1)),
col="gray",type="l",ylab="Survival probability",cex.axis=1.2,xlab="",cex.lab=1.4,las=1,xlim=c(0,110))
points(sort(f2$Stime_resc),rev(100*(1:length(f2$Stime_resc)-1)/(length(f2$Stime_resc)-1)),col="gray",type="l")
points(sort(f3$Stime_resc),rev(100*(1:length(f3$Stime_resc)-1)/(length(f3$Stime_resc)-1)),col="gray",type="l")
points(sort(f4$Stime_resc),rev(100*(1:length(f4$Stime_resc)-1)/(length(f4$Stime_resc)-1)),col="gray",type="l")
points(sort(f5$Stime_resc),rev(100*(1:length(f5$Stime_resc)-1)/(length(f5$Stime_resc)-1)),col="gray",type="l")
points(sort(f6$Stime_resc),rev(100*(1:length(f6$Stime_resc)-1)/(length(f6$Stime_resc)-1)),col="gray",type="l")
points(sort(f7$Stime_resc),rev(100*(1:length(f7$Stime_resc)-1)/(length(f7$Stime_resc)-1)),col="gray",type="l")
points(sort(f8$Stime_resc),rev(100*(1:length(f8$Stime_resc)-1)/(length(f8$Stime_resc)-1)),col="gray",type="l")
points(sort(f9$Stime_resc),rev(100*(1:length(f9$Stime_resc)-1)/(length(f9$Stime_resc)-1)),col="gray",type="l")
points(sort(f10$Stime_resc),rev(100*(1:length(f10$Stime_resc)-1)/(length(f10$Stime_resc)-1)),col="gray",type="l")
points(sort(f11$Stime_resc),rev(100*(1:length(f11$Stime_resc)-1)/(length(f11$Stime_resc)-1)),col="gray",type="l")
points(sort(f12$Stime_resc),rev(100*(1:length(f12$Stime_resc)-1)/(length(f12$Stime_resc)-1)),col="gray",type="l")
points(sort(f13$Stime_resc),rev(100*(1:length(f13$Stime_resc)-1)/(length(f13$Stime_resc)-1)),col="gray",type="l")
points(sort(f14$Stime_resc),rev(100*(1:length(f14$Stime_resc)-1)/(length(f14$Stime_resc)-1)),col="gray",type="l")
points(sort(f15$Stime_resc),rev(100*(1:length(f15$Stime_resc)-1)/(length(f15$Stime_resc)-1)),col="gray",type="l")
points(sort(f16$Stime_resc),rev(100*(1:length(f16$Stime_resc)-1)/(length(f16$Stime_resc)-1)),col="gray",type="l")
points(sort(f17$Stime_resc),rev(100*(1:length(f17$Stime_resc)-1)/(length(f17$Stime_resc)-1)),col="gray",type="l")
points(sort(f18$Stime_resc),rev(100*(1:length(f18$Stime_resc)-1)/(length(f18$Stime_resc)-1)),col="gray",type="l")
points(sort(f19$Stime_resc),rev(100*(1:length(f19$Stime_resc)-1)/(length(f19$Stime_resc)-1)),col="gray",type="l")
points(sort(f20$Stime_resc),rev(100*(1:length(f20$Stime_resc)-1)/(length(f20$Stime_resc)-1)),col="gray",type="l")
points(sort(fall$Stime_resc),rev(100*(1:length(fall$Stime_resc)-1)/(length(fall$Stime_resc)-1)),col="#4DAC26",lwd=3,type="l")
text(70,92,"Inbred lines",col="gray",adj=0,font=2,cex=1.2)
text(70,85,"Pooled lines",adj=0,col="#4DAC26",font=2,cex=1.2)
#-----------------------------------------------------------------------------
#males
# labels
labs= c("1","2","5","10","30","120","420")
xs= log10(c(1,2,5,10,30,60*2,60*7))
par(mai=c(0.55,0.6,0,0.1))
plot(surv.time ~ jitter(test.temp,0.5),xlim=c(35.6,39.4),ylim=c(0,3),yaxt="n",
cex.axis=1.2, cex.lab=1.4,cex=1.4,pch=16,col="#A6761D70",
xlab="Test temperature (°C)",ylab="Time (min)",data=m.25180)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.25182)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.25190)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.25192)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.25198)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.25201)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.25203)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28135)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28141)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28153)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28173)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28180)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28191)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28196)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28197)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28198)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28247)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28248)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28258)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.29652)
abline(lm(surv.time ~ test.temp,data = m.25180),col="gray")
abline(lm(surv.time ~ test.temp,data = m.25182),col="gray")
abline(lm(surv.time ~ test.temp,data = m.25190),col="gray")
abline(lm(surv.time ~ test.temp,data = m.25192),col="gray")
abline(lm(surv.time ~ test.temp,data = m.25198),col="gray")
abline(lm(surv.time ~ test.temp,data = m.25201),col="gray")
abline(lm(surv.time ~ test.temp,data = m.25203),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28135),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28141),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28153),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28173),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28180),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28191),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28196),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28197),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28198),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28247),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28248),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28258),col="gray")
abline(lm(surv.time ~ test.temp,data = m.29652),col="gray")
abline(lm(surv.time ~ test.temp,data = data_m),col="#A6761D",lwd=3)
#update axis
axis(2, at=xs, labels=labs, cex.axis=1.2)
par(mai=c(0.55,0.6,0,0.1))
plot(sort(m1$Stime_resc),rev(100*(1:length(m1$Stime_resc)-1)/(length(m1$Stime_resc)-1)),
col="gray",type="l",ylab="Survival probability",xlab="Time (min)",cex.axis=1.2, cex.lab=1.4,las=1,xlim=c(0,110))
points(sort(m2$Stime_resc),rev(100*(1:length(m2$Stime_resc)-1)/(length(m2$Stime_resc)-1)),col="gray",type="l")
points(sort(m3$Stime_resc),rev(100*(1:length(m3$Stime_resc)-1)/(length(m3$Stime_resc)-1)),col="gray",type="l")
points(sort(m4$Stime_resc),rev(100*(1:length(m4$Stime_resc)-1)/(length(m4$Stime_resc)-1)),col="gray",type="l")
points(sort(m5$Stime_resc),rev(100*(1:length(m5$Stime_resc)-1)/(length(m5$Stime_resc)-1)),col="gray",type="l")
points(sort(m6$Stime_resc),rev(100*(1:length(m6$Stime_resc)-1)/(length(m6$Stime_resc)-1)),col="gray",type="l")
points(sort(m7$Stime_resc),rev(100*(1:length(m7$Stime_resc)-1)/(length(m7$Stime_resc)-1)),col="gray",type="l")
points(sort(m8$Stime_resc),rev(100*(1:length(m8$Stime_resc)-1)/(length(m8$Stime_resc)-1)),col="gray",type="l")
points(sort(m9$Stime_resc),rev(100*(1:length(m9$Stime_resc)-1)/(length(m9$Stime_resc)-1)),col="gray",type="l")
points(sort(m10$Stime_resc),rev(100*(1:length(m10$Stime_resc)-1)/(length(m10$Stime_resc)-1)),col="gray",type="l")
points(sort(m11$Stime_resc),rev(100*(1:length(m11$Stime_resc)-1)/(length(m11$Stime_resc)-1)),col="gray",type="l")
points(sort(m12$Stime_resc),rev(100*(1:length(m12$Stime_resc)-1)/(length(m12$Stime_resc)-1)),col="gray",type="l")
points(sort(m13$Stime_resc),rev(100*(1:length(m13$Stime_resc)-1)/(length(m13$Stime_resc)-1)),col="gray",type="l")
points(sort(m14$Stime_resc),rev(100*(1:length(m14$Stime_resc)-1)/(length(m14$Stime_resc)-1)),col="gray",type="l")
points(sort(m15$Stime_resc),rev(100*(1:length(m15$Stime_resc)-1)/(length(m15$Stime_resc)-1)),col="gray",type="l")
points(sort(m16$Stime_resc),rev(100*(1:length(m16$Stime_resc)-1)/(length(m16$Stime_resc)-1)),col="gray",type="l")
points(sort(m17$Stime_resc),rev(100*(1:length(m17$Stime_resc)-1)/(length(m17$Stime_resc)-1)),col="gray",type="l")
points(sort(m18$Stime_resc),rev(100*(1:length(m18$Stime_resc)-1)/(length(m18$Stime_resc)-1)),col="gray",type="l")
points(sort(m19$Stime_resc),rev(100*(1:length(m19$Stime_resc)-1)/(length(m19$Stime_resc)-1)),col="gray",type="l")
points(sort(m20$Stime_resc),rev(100*(1:length(m20$Stime_resc)-1)/(length(m20$Stime_resc)-1)),col="gray",type="l")
points(sort(mall$Stime_resc),rev(100*(1:length(mall$Stime_resc)-1)/(length(mall$Stime_resc)-1)),col="#A6761D",lwd=3,type="l")
text(70,92,"Inbred lines",col="gray",adj=0,font=2,cex=1.2)
text(70,85,"Pooled lines",adj=0,col="#A6761D",font=2,cex=1.2)
# close device
dev.off()
}
#-------------------------------------------------------------------------------
# FIGURE 1
#-------------------------------------------------------------------------------
{
pdf("../Outputs/1.2.1. Figure 1 Survival probabilities of DGRP lines.pdf",width = 6,height = 8,useDingbats = FALSE)
#png("../Outputs/1.2.1. Figure 1 Survival probabilities of DGRP lines.png",width = 6,height = 8,units = "in",res = 600)
par(mfrow=c(3,2),tcl=-0.4, family="serif",omi=c(0,0,0,0))
#Sexes pooled
# labels
labs= c("1","2","5","10","30","120","420")
xs= log10(c(1,2,5,10,30,60*2,60*7))
par(mai=c(0.55,0.6,0.1,0.1))
#TDT plots
plot(surv.time ~ jitter(test.temp,0.5),xlim=c(35.6,39.4),ylim=c(0,3),cex.axis=1.2,
cex.lab=1.4,yaxt="n",cex=1.4,pch=16,col="#55555540",xlab="",ylab="",data=p.25180)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.25182)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.25190)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.25192)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.25198)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.25201)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.25203)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28135)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28141)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28153)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28173)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28180)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28191)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28196)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28197)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28198)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28247)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28248)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.28258)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#55555540",data=p.29652)
abline(lm(surv.time ~ test.temp,data = p.25180),col="gray")
abline(lm(surv.time ~ test.temp,data = p.25182),col="gray")
abline(lm(surv.time ~ test.temp,data = p.25190),col="gray")
abline(lm(surv.time ~ test.temp,data = p.25192),col="gray")
abline(lm(surv.time ~ test.temp,data = p.25198),col="gray")
abline(lm(surv.time ~ test.temp,data = p.25201),col="gray")
abline(lm(surv.time ~ test.temp,data = p.25203),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28135),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28141),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28153),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28173),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28180),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28191),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28196),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28197),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28198),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28247),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28248),col="gray")
abline(lm(surv.time ~ test.temp,data = p.28258),col="gray")
abline(lm(surv.time ~ test.temp,data = p.29652),col="gray")
abline(lm(surv.time ~ test.temp,data = all.lines.21),col="#555555",lwd=3)
#update axis
axis(2, at=xs, labels=labs, cex.axis=1.2)
#survival plots
par(mai=c(0.55,0.6,0.1,0.1))
plot(sort(p1$Stime_resc),rev(100*(1:length(p1$Stime_resc)-1)/(length(p1$Stime_resc)-1)),
col="gray",type="l",ylab="Survival probability",xlab="",cex.axis=1.2, cex.lab=1.4,las=1,xlim=c(0,110))
points(sort(p2$Stime_resc),rev(100*(1:length(p2$Stime_resc)-1)/(length(p2$Stime_resc)-1)),col="gray",type="l")
points(sort(p3$Stime_resc),rev(100*(1:length(p3$Stime_resc)-1)/(length(p3$Stime_resc)-1)),col="gray",type="l")
points(sort(p4$Stime_resc),rev(100*(1:length(p4$Stime_resc)-1)/(length(p4$Stime_resc)-1)),col="gray",type="l")
points(sort(p5$Stime_resc),rev(100*(1:length(p5$Stime_resc)-1)/(length(p5$Stime_resc)-1)),col="gray",type="l")
points(sort(p6$Stime_resc),rev(100*(1:length(p6$Stime_resc)-1)/(length(p6$Stime_resc)-1)),col="gray",type="l")
points(sort(p7$Stime_resc),rev(100*(1:length(p7$Stime_resc)-1)/(length(p7$Stime_resc)-1)),col="gray",type="l")
points(sort(p8$Stime_resc),rev(100*(1:length(p8$Stime_resc)-1)/(length(p8$Stime_resc)-1)),col="gray",type="l")
points(sort(p9$Stime_resc),rev(100*(1:length(p9$Stime_resc)-1)/(length(p9$Stime_resc)-1)),col="gray",type="l")
points(sort(p10$Stime_resc),rev(100*(1:length(p10$Stime_resc)-1)/(length(p10$Stime_resc)-1)),col="gray",type="l")
points(sort(p11$Stime_resc),rev(100*(1:length(p11$Stime_resc)-1)/(length(p11$Stime_resc)-1)),col="gray",type="l")
points(sort(p12$Stime_resc),rev(100*(1:length(p12$Stime_resc)-1)/(length(p12$Stime_resc)-1)),col="gray",type="l")
points(sort(p13$Stime_resc),rev(100*(1:length(p13$Stime_resc)-1)/(length(p13$Stime_resc)-1)),col="gray",type="l")
points(sort(p14$Stime_resc),rev(100*(1:length(p14$Stime_resc)-1)/(length(p14$Stime_resc)-1)),col="gray",type="l")
points(sort(p15$Stime_resc),rev(100*(1:length(p15$Stime_resc)-1)/(length(p15$Stime_resc)-1)),col="gray",type="l")
points(sort(p16$Stime_resc),rev(100*(1:length(p16$Stime_resc)-1)/(length(p16$Stime_resc)-1)),col="gray",type="l")
points(sort(p17$Stime_resc),rev(100*(1:length(p17$Stime_resc)-1)/(length(p17$Stime_resc)-1)),col="gray",type="l")
points(sort(p18$Stime_resc),rev(100*(1:length(p18$Stime_resc)-1)/(length(p18$Stime_resc)-1)),col="gray",type="l")
points(sort(p19$Stime_resc),rev(100*(1:length(p19$Stime_resc)-1)/(length(p19$Stime_resc)-1)),col="gray",type="l")
points(sort(p20$Stime_resc),rev(100*(1:length(p20$Stime_resc)-1)/(length(p20$Stime_resc)-1)),col="gray",type="l")
points(sort(pall$Stime_resc),rev(100*(1:length(pall$Stime_resc)-1)/(length(pall$Stime_resc)-1)),col="#555555",lwd=3,type="l")
text(70,92,"Inbred lines",col="gray",adj=0,font=2,cex=1.2)
text(70,85,"Pooled lines",adj=0,col="#555555",font=2,cex=1.2)
#-----------------------------------------------------------------------------
#females
# labels
labs= c("1","2","5","10","30","120","420")
xs= log10(c(1,2,5,10,30,60*2,60*7))
#TDT curves
par(mai=c(0.55,0.6,0,0.1))
plot(surv.time ~ jitter(test.temp,0.5),xlim=c(35.6,39.4),ylim=c(0,3),cex.axis=1.2, cex.lab=1.4,yaxt="n",cex=1.4,pch=16,
col="#4DAC2660",xlab="",ylab="",data=f.25180)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.25182)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.25190)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.25192)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.25198)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.25201)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.25203)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28135)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28141)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28153)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28173)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28180)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28191)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28196)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28197)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28198)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28247)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28248)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.28258)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#4DAC2660",data=f.29652)
abline(lm(surv.time ~ test.temp,data = f.25180),col="gray")
abline(lm(surv.time ~ test.temp,data = f.25182),col="gray")
abline(lm(surv.time ~ test.temp,data = f.25190),col="gray")
abline(lm(surv.time ~ test.temp,data = f.25192),col="gray")
abline(lm(surv.time ~ test.temp,data = f.25198),col="gray")
abline(lm(surv.time ~ test.temp,data = f.25201),col="gray")
abline(lm(surv.time ~ test.temp,data = f.25203),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28135),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28141),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28153),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28173),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28180),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28191),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28196),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28197),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28198),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28247),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28248),col="gray")
abline(lm(surv.time ~ test.temp,data = f.28258),col="gray")
abline(lm(surv.time ~ test.temp,data = f.29652),col="gray")
abline(lm(surv.time ~ test.temp,data = data_f),col="#4DAC26",lwd=3)
#update axis
axis(2, at=xs, labels=labs, cex.axis=1.2)
par(mai=c(0.55,0.6,0,0.1))
plot(sort(f1$Stime_resc),rev(100*(1:length(f1$Stime_resc)-1)/(length(f1$Stime_resc)-1)),
col="gray",type="l",ylab="Survival probability",cex.axis=1.2,xlab="",cex.lab=1.4,las=1,xlim=c(0,110))
points(sort(f2$Stime_resc),rev(100*(1:length(f2$Stime_resc)-1)/(length(f2$Stime_resc)-1)),col="gray",type="l")
points(sort(f3$Stime_resc),rev(100*(1:length(f3$Stime_resc)-1)/(length(f3$Stime_resc)-1)),col="gray",type="l")
points(sort(f4$Stime_resc),rev(100*(1:length(f4$Stime_resc)-1)/(length(f4$Stime_resc)-1)),col="gray",type="l")
points(sort(f5$Stime_resc),rev(100*(1:length(f5$Stime_resc)-1)/(length(f5$Stime_resc)-1)),col="gray",type="l")
points(sort(f6$Stime_resc),rev(100*(1:length(f6$Stime_resc)-1)/(length(f6$Stime_resc)-1)),col="gray",type="l")
points(sort(f7$Stime_resc),rev(100*(1:length(f7$Stime_resc)-1)/(length(f7$Stime_resc)-1)),col="gray",type="l")
points(sort(f8$Stime_resc),rev(100*(1:length(f8$Stime_resc)-1)/(length(f8$Stime_resc)-1)),col="gray",type="l")
points(sort(f9$Stime_resc),rev(100*(1:length(f9$Stime_resc)-1)/(length(f9$Stime_resc)-1)),col="gray",type="l")
points(sort(f10$Stime_resc),rev(100*(1:length(f10$Stime_resc)-1)/(length(f10$Stime_resc)-1)),col="gray",type="l")
points(sort(f11$Stime_resc),rev(100*(1:length(f11$Stime_resc)-1)/(length(f11$Stime_resc)-1)),col="gray",type="l")
points(sort(f12$Stime_resc),rev(100*(1:length(f12$Stime_resc)-1)/(length(f12$Stime_resc)-1)),col="gray",type="l")
points(sort(f13$Stime_resc),rev(100*(1:length(f13$Stime_resc)-1)/(length(f13$Stime_resc)-1)),col="gray",type="l")
points(sort(f14$Stime_resc),rev(100*(1:length(f14$Stime_resc)-1)/(length(f14$Stime_resc)-1)),col="gray",type="l")
points(sort(f15$Stime_resc),rev(100*(1:length(f15$Stime_resc)-1)/(length(f15$Stime_resc)-1)),col="gray",type="l")
points(sort(f16$Stime_resc),rev(100*(1:length(f16$Stime_resc)-1)/(length(f16$Stime_resc)-1)),col="gray",type="l")
points(sort(f17$Stime_resc),rev(100*(1:length(f17$Stime_resc)-1)/(length(f17$Stime_resc)-1)),col="gray",type="l")
points(sort(f18$Stime_resc),rev(100*(1:length(f18$Stime_resc)-1)/(length(f18$Stime_resc)-1)),col="gray",type="l")
points(sort(f19$Stime_resc),rev(100*(1:length(f19$Stime_resc)-1)/(length(f19$Stime_resc)-1)),col="gray",type="l")
points(sort(f20$Stime_resc),rev(100*(1:length(f20$Stime_resc)-1)/(length(f20$Stime_resc)-1)),col="gray",type="l")
points(sort(fall$Stime_resc),rev(100*(1:length(fall$Stime_resc)-1)/(length(fall$Stime_resc)-1)),col="#4DAC26",lwd=3,type="l")
text(70,92,"Inbred lines",col="gray",adj=0,font=2,cex=1.2)
text(70,85,"Pooled lines",adj=0,col="#4DAC26",font=2,cex=1.2)
#-----------------------------------------------------------------------------
#males
# labels
labs= c("1","2","5","10","30","120","420")
xs= log10(c(1,2,5,10,30,60*2,60*7))
par(mai=c(0.55,0.6,0,0.1))
plot(surv.time ~ jitter(test.temp,0.5),xlim=c(35.6,39.4),ylim=c(0,3),yaxt="n",
cex.axis=1.2, cex.lab=1.4,cex=1.4,pch=16,col="#A6761D70",
xlab="Test temperature (°C)",ylab="Time (min)",data=m.25180)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.25182)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.25190)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.25192)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.25198)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.25201)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.25203)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28135)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28141)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28153)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28173)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28180)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28191)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28196)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28197)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28198)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28247)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28248)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.28258)
points(surv.time ~ jitter(test.temp,0.5),cex=1.4,pch=16,col="#A6761D70",data=m.29652)
abline(lm(surv.time ~ test.temp,data = m.25180),col="gray")
abline(lm(surv.time ~ test.temp,data = m.25182),col="gray")
abline(lm(surv.time ~ test.temp,data = m.25190),col="gray")
abline(lm(surv.time ~ test.temp,data = m.25192),col="gray")
abline(lm(surv.time ~ test.temp,data = m.25198),col="gray")
abline(lm(surv.time ~ test.temp,data = m.25201),col="gray")
abline(lm(surv.time ~ test.temp,data = m.25203),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28135),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28141),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28153),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28173),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28180),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28191),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28196),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28197),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28198),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28247),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28248),col="gray")
abline(lm(surv.time ~ test.temp,data = m.28258),col="gray")
abline(lm(surv.time ~ test.temp,data = m.29652),col="gray")
abline(lm(surv.time ~ test.temp,data = data_m),col="#A6761D",lwd=3)
#update axis
axis(2, at=xs, labels=labs, cex.axis=1.2)
par(mai=c(0.55,0.6,0,0.1))
plot(sort(m1$Stime_resc),rev(100*(1:length(m1$Stime_resc)-1)/(length(m1$Stime_resc)-1)),
col="gray",type="l",ylab="Survival probability",xlab="Time (min)",cex.axis=1.2, cex.lab=1.4,las=1,xlim=c(0,110))
points(sort(m2$Stime_resc),rev(100*(1:length(m2$Stime_resc)-1)/(length(m2$Stime_resc)-1)),col="gray",type="l")
points(sort(m3$Stime_resc),rev(100*(1:length(m3$Stime_resc)-1)/(length(m3$Stime_resc)-1)),col="gray",type="l")
points(sort(m4$Stime_resc),rev(100*(1:length(m4$Stime_resc)-1)/(length(m4$Stime_resc)-1)),col="gray",type="l")
points(sort(m5$Stime_resc),rev(100*(1:length(m5$Stime_resc)-1)/(length(m5$Stime_resc)-1)),col="gray",type="l")
points(sort(m6$Stime_resc),rev(100*(1:length(m6$Stime_resc)-1)/(length(m6$Stime_resc)-1)),col="gray",type="l")
points(sort(m7$Stime_resc),rev(100*(1:length(m7$Stime_resc)-1)/(length(m7$Stime_resc)-1)),col="gray",type="l")
points(sort(m8$Stime_resc),rev(100*(1:length(m8$Stime_resc)-1)/(length(m8$Stime_resc)-1)),col="gray",type="l")
points(sort(m9$Stime_resc),rev(100*(1:length(m9$Stime_resc)-1)/(length(m9$Stime_resc)-1)),col="gray",type="l")
points(sort(m10$Stime_resc),rev(100*(1:length(m10$Stime_resc)-1)/(length(m10$Stime_resc)-1)),col="gray",type="l")
points(sort(m11$Stime_resc),rev(100*(1:length(m11$Stime_resc)-1)/(length(m11$Stime_resc)-1)),col="gray",type="l")
points(sort(m12$Stime_resc),rev(100*(1:length(m12$Stime_resc)-1)/(length(m12$Stime_resc)-1)),col="gray",type="l")
points(sort(m13$Stime_resc),rev(100*(1:length(m13$Stime_resc)-1)/(length(m13$Stime_resc)-1)),col="gray",type="l")
points(sort(m14$Stime_resc),rev(100*(1:length(m14$Stime_resc)-1)/(length(m14$Stime_resc)-1)),col="gray",type="l")
points(sort(m15$Stime_resc),rev(100*(1:length(m15$Stime_resc)-1)/(length(m15$Stime_resc)-1)),col="gray",type="l")
points(sort(m16$Stime_resc),rev(100*(1:length(m16$Stime_resc)-1)/(length(m16$Stime_resc)-1)),col="gray",type="l")
points(sort(m17$Stime_resc),rev(100*(1:length(m17$Stime_resc)-1)/(length(m17$Stime_resc)-1)),col="gray",type="l")
points(sort(m18$Stime_resc),rev(100*(1:length(m18$Stime_resc)-1)/(length(m18$Stime_resc)-1)),col="gray",type="l")
points(sort(m19$Stime_resc),rev(100*(1:length(m19$Stime_resc)-1)/(length(m19$Stime_resc)-1)),col="gray",type="l")
points(sort(m20$Stime_resc),rev(100*(1:length(m20$Stime_resc)-1)/(length(m20$Stime_resc)-1)),col="gray",type="l")
points(sort(mall$Stime_resc),rev(100*(1:length(mall$Stime_resc)-1)/(length(mall$Stime_resc)-1)),col="#A6761D",lwd=3,type="l")
text(70,92,"Inbred lines",col="gray",adj=0,font=2,cex=1.2)
text(70,85,"Pooled lines",adj=0,col="#A6761D",font=2,cex=1.2)
# close device
dev.off()
}
