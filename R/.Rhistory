str(datos)
head(datos)
# ------------------------------------------------------------------------------
# convert survival time to decimal of minutes
datos$surv.time<-log10(datos$TIME_SURV_MIN+(datos$TIME_SURV_SEC/60))
datos$video.time<-log10(datos$VIDEO_DURATION_MIN+(datos$VIDEO_DURATION_SEC/60))
# ------------------------------------------------------------------------------
#select columns of interest
names(datos)
datos2<-datos[c(2:7,9,10,13,18:28)]
# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------
# Script to explore data and calculate survival times of DGRP lines
# ------------------------------------------------------------------------------
# Data generated by Félix P Leiva (e-mail: felixpleiva@gmail.com)
# Script created by Félix P Leiva (e-mail: felixpleiva@gmail.com)
# ------------------------------------------------------------------------------
# Cite as:
# Leiva FP, Santos M, Rezende E, & Verberk WCEP. (2022). Data and code of
# manuscript: Genetic variation on heat tolerance in a model ectotherm. Zenodo.
# (DOI is coming)
# ------------------------------------------------------------------------------
# Cleaning working space
rm(list=ls())
today<-format(Sys.Date(),"%Y%m%d")
# ------------------------------------------------------------------------------
# set the working directory to the folder containing this script:
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# ------------------------------------------------------------------------------
# check directory
getwd()
# ------------------------------------------------------------------------------
#Libraries
library(xlsx)
library(dplyr)
# ------------------------------------------------------------------------------
#read data of survival time
datos<-read.xlsx("../Data/TDT_DGRP_lines.xlsx", sheetName = "results on TDT available")
#Check data structure
str(datos)
# ------------------------------------------------------------------------------
# convert variables
datos$NUMBER_STOCK<-as.factor(datos$NUMBER_STOCK)
datos$FLASK_NUMBER<-as.factor(datos$FLASK_NUMBER)
datos$STRESS_TEMP<-as.numeric(datos$STRESS_TEMP)
datos$RUN_NUMBER<-as.factor(datos$RUN_NUMBER)
datos$DATE_REV<-as.factor(datos$DATE_REV)
datos$TIME_SURV_MIN<-as.numeric(datos$TIME_SURV_MIN)
datos$TIME_SURV_SEC<-as.numeric(datos$TIME_SURV_SEC)
datos$VIDEO_DURATION_MIN<-as.numeric(datos$VIDEO_DURATION_MIN)
datos$VIDEO_DURATION_SEC<-as.numeric(datos$VIDEO_DURATION_SEC)
datos$ACCLIM_TIME<-as.numeric(datos$ACCLIM_TIME)
datos$TEST_OXYGEN<-as.numeric(datos$TEST_OXYGEN)
datos$PLATE_NAME<-as.factor(datos$PLATE_NAME)
datos$WELL<-as.factor(datos$WELL)
datos$READER<-as.factor(datos$READER)
datos$GENOTYPE<-as.factor(datos$GENOTYPE)
datos$SEX<-as.factor(datos$SEX)
datos$VIDEO_NAME<-as.factor(datos$VIDEO_NAME)
datos$DATE_REV<-as.factor(datos$DATE_REV)
# ------------------------------------------------------------------------------
# check again
str(datos)
head(datos)
# ------------------------------------------------------------------------------
# convert survival time to decimal of minutes
datos$surv.time<-log10(datos$TIME_SURV_MIN+(datos$TIME_SURV_SEC/60))
datos$video.time<-log10(datos$VIDEO_DURATION_MIN+(datos$VIDEO_DURATION_SEC/60))
# ------------------------------------------------------------------------------
#select columns of interest
names(datos)
datos<-read.xlsx("../Data/TDT_DGRP_lines.xlsx", sheetName = "results on TDT available")
#Check data structure
str(datos)
# ------------------------------------------------------------------------------
# convert variables
datos$NUMBER_STOCK<-as.factor(datos$NUMBER_STOCK)
datos$FLASK_NUMBER<-as.factor(datos$FLASK_NUMBER)
datos$STRESS_TEMP<-as.numeric(datos$STRESS_TEMP)
datos$RUN_NUMBER<-as.factor(datos$RUN_NUMBER)
datos$DATE_REV<-as.factor(datos$DATE_REV)
datos$TIME_SURV_MIN<-as.numeric(datos$TIME_SURV_MIN)
datos$TIME_SURV_SEC<-as.numeric(datos$TIME_SURV_SEC)
datos$VIDEO_DURATION_MIN<-as.numeric(datos$VIDEO_DURATION_MIN)
datos$VIDEO_DURATION_SEC<-as.numeric(datos$VIDEO_DURATION_SEC)
datos$ACCLIM_TIME<-as.numeric(datos$ACCLIM_TIME)
datos$TEST_OXYGEN<-as.numeric(datos$TEST_OXYGEN)
datos$PLATE_NAME<-as.factor(datos$PLATE_NAME)
datos$WELL<-as.factor(datos$WELL)
datos$READER<-as.factor(datos$READER)
datos$GENOTYPE<-as.factor(datos$GENOTYPE)
datos$SEX<-as.factor(datos$SEX)
datos$VIDEO_NAME<-as.factor(datos$VIDEO_NAME)
datos$DATE_REV<-as.factor(datos$DATE_REV)
# ------------------------------------------------------------------------------
# check again
str(datos)
head(datos)
# ------------------------------------------------------------------------------
# convert survival time to decimal of minutes
datos$surv.time<-log10(datos$TIME_SURV_MIN+(datos$TIME_SURV_SEC/60))
datos$video.time<-log10(datos$VIDEO_DURATION_MIN+(datos$VIDEO_DURATION_SEC/60))
# ------------------------------------------------------------------------------
#select columns of interest
names(datos)
datos2<-datos[c(2:7,9,10,13,18:28)]
# ------------------------------------------------------------------------------
#Select only flies measured at 21 KPa
all.21<-filter(datos2,test.oxygen==21)
# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------
#Select only flies measured at 21 KPa
all.21<-filter(datos2,TEST_OXYGEN==21)
# ------------------------------------------------------------------------------
#Select only flies measured at 21 KPa
datos2<-filter(datos2,TEST_OXYGEN==21)
# ------------------------------------------------------------------------------
#Libraries
library(xlsx)
library(dplyr)
# ------------------------------------------------------------------------------
#read data of survival time
datos<-read.xlsx("../Data/TDT_DGRP_lines.xlsx", sheetName = "results on TDT available")
#Check data structure
str(datos)
# ------------------------------------------------------------------------------
# convert variables
datos$NUMBER_STOCK<-as.factor(datos$NUMBER_STOCK)
# ------------------------------------------------------------------------------
# convert variables
datos$NUMBER_STOCK<-as.factor(datos$NUMBER_STOCK)
datos$FLASK_NUMBER<-as.factor(datos$FLASK_NUMBER)
datos$STRESS_TEMP<-as.numeric(datos$STRESS_TEMP)
datos$RUN_NUMBER<-as.factor(datos$RUN_NUMBER)
datos$DATE_REV<-as.factor(datos$DATE_REV)
datos$TIME_SURV_MIN<-as.numeric(datos$TIME_SURV_MIN)
datos$TIME_SURV_SEC<-as.numeric(datos$TIME_SURV_SEC)
datos$VIDEO_DURATION_MIN<-as.numeric(datos$VIDEO_DURATION_MIN)
datos$VIDEO_DURATION_SEC<-as.numeric(datos$VIDEO_DURATION_SEC)
datos$ACCLIM_TIME<-as.numeric(datos$ACCLIM_TIME)
datos$TEST_OXYGEN<-as.numeric(datos$TEST_OXYGEN)
datos$PLATE_NAME<-as.factor(datos$PLATE_NAME)
datos$WELL<-as.factor(datos$WELL)
datos$READER<-as.factor(datos$READER)
datos$GENOTYPE<-as.factor(datos$GENOTYPE)
datos$SEX<-as.factor(datos$SEX)
datos$VIDEO_NAME<-as.factor(datos$VIDEO_NAME)
datos$DATE_REV<-as.factor(datos$DATE_REV)
# ------------------------------------------------------------------------------
# check again
str(datos)
head(datos)
# ------------------------------------------------------------------------------
# convert survival time to decimal of minutes
datos$surv.time<-log10(datos$TIME_SURV_MIN+(datos$TIME_SURV_SEC/60))
datos$video.time<-log10(datos$VIDEO_DURATION_MIN+(datos$VIDEO_DURATION_SEC/60))
# ------------------------------------------------------------------------------
#select columns of interest
names(datos)
# ------------------------------------------------------------------------------
# Script to explore data and calculate survival times of DGRP lines
# ------------------------------------------------------------------------------
# Data generated by Félix P Leiva (e-mail: felixpleiva@gmail.com)
# Script created by Félix P Leiva (e-mail: felixpleiva@gmail.com)
# ------------------------------------------------------------------------------
# Cite as:
# Leiva FP, Santos M, Rezende E, & Verberk WCEP. (2022). Data and code of
# manuscript: Genetic variation on heat tolerance in a model ectotherm. Zenodo.
# (DOI is coming)
# ------------------------------------------------------------------------------
# Cleaning working space
rm(list=ls())
today<-format(Sys.Date(),"%Y%m%d")
# ------------------------------------------------------------------------------
# set the working directory to the folder containing this script:
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# ------------------------------------------------------------------------------
# check directory
getwd()
# ------------------------------------------------------------------------------
#Libraries
library(xlsx)
library(dplyr)
# ------------------------------------------------------------------------------
#read data of survival time
datos<-read.xlsx("../Data/TDT_DGRP_lines.xlsx", sheetName = "results on TDT available")
#Check data structure
str(datos)
# ------------------------------------------------------------------------------
# convert variables
datos$NUMBER_STOCK<-as.factor(datos$NUMBER_STOCK)
datos$FLASK_NUMBER<-as.factor(datos$FLASK_NUMBER)
datos$STRESS_TEMP<-as.numeric(datos$STRESS_TEMP)
datos$RUN_NUMBER<-as.factor(datos$RUN_NUMBER)
datos$DATE_REV<-as.factor(datos$DATE_REV)
datos$TIME_SURV_MIN<-as.numeric(datos$TIME_SURV_MIN)
datos$TIME_SURV_SEC<-as.numeric(datos$TIME_SURV_SEC)
datos$VIDEO_DURATION_MIN<-as.numeric(datos$VIDEO_DURATION_MIN)
datos$VIDEO_DURATION_SEC<-as.numeric(datos$VIDEO_DURATION_SEC)
datos$ACCLIM_TIME<-as.numeric(datos$ACCLIM_TIME)
datos$TEST_OXYGEN<-as.numeric(datos$TEST_OXYGEN)
datos$PLATE_NAME<-as.factor(datos$PLATE_NAME)
datos$WELL<-as.factor(datos$WELL)
datos$READER<-as.factor(datos$READER)
datos$GENOTYPE<-as.factor(datos$GENOTYPE)
datos$SEX<-as.factor(datos$SEX)
datos$VIDEO_NAME<-as.factor(datos$VIDEO_NAME)
datos$DATE_REV<-as.factor(datos$DATE_REV)
# ------------------------------------------------------------------------------
# check again
str(datos)
head(datos)
# ------------------------------------------------------------------------------
# convert survival time to decimal of minutes
datos$surv.time<-log10(datos$TIME_SURV_MIN+(datos$TIME_SURV_SEC/60))
datos$video.time<-log10(datos$VIDEO_DURATION_MIN+(datos$VIDEO_DURATION_SEC/60))
# ------------------------------------------------------------------------------
#select columns of interest
names(datos)
# ------------------------------------------------------------------------------
# Script to explore data and calculate survival times of DGRP lines
# ------------------------------------------------------------------------------
# Data generated by Félix P Leiva (e-mail: felixpleiva@gmail.com)
# Script created by Félix P Leiva (e-mail: felixpleiva@gmail.com)
# ------------------------------------------------------------------------------
# Cite as:
# Leiva FP, Santos M, Rezende E, & Verberk WCEP. (2022). Data and code of
# manuscript: Genetic variation on heat tolerance in a model ectotherm. Zenodo.
# (DOI is coming)
# ------------------------------------------------------------------------------
# Cleaning working space
rm(list=ls())
today<-format(Sys.Date(),"%Y%m%d")
# ------------------------------------------------------------------------------
# set the working directory to the folder containing this script:
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# ------------------------------------------------------------------------------
# check directory
getwd()
# ------------------------------------------------------------------------------
#Libraries
library(xlsx)
library(dplyr)
# ------------------------------------------------------------------------------
#read data of survival time
datos<-read.xlsx("../Data/TDT_DGRP_lines.xlsx", sheetName = "results on TDT available")
#Check data structure
str(datos)
# ------------------------------------------------------------------------------
# convert variables
datos$NUMBER_STOCK<-as.factor(datos$NUMBER_STOCK)
datos$FLASK_NUMBER<-as.factor(datos$FLASK_NUMBER)
datos$STRESS_TEMP<-as.numeric(datos$STRESS_TEMP)
datos$RUN_NUMBER<-as.factor(datos$RUN_NUMBER)
datos$DATE_REV<-as.factor(datos$DATE_REV)
datos$TIME_SURV_MIN<-as.numeric(datos$TIME_SURV_MIN)
datos$TIME_SURV_SEC<-as.numeric(datos$TIME_SURV_SEC)
datos$VIDEO_DURATION_MIN<-as.numeric(datos$VIDEO_DURATION_MIN)
datos$VIDEO_DURATION_SEC<-as.numeric(datos$VIDEO_DURATION_SEC)
datos$ACCLIM_TIME<-as.numeric(datos$ACCLIM_TIME)
datos$TEST_OXYGEN<-as.numeric(datos$TEST_OXYGEN)
datos$PLATE_NAME<-as.factor(datos$PLATE_NAME)
datos$WELL<-as.factor(datos$WELL)
datos$READER<-as.factor(datos$READER)
datos$GENOTYPE<-as.factor(datos$GENOTYPE)
datos$SEX<-as.factor(datos$SEX)
datos$VIDEO_NAME<-as.factor(datos$VIDEO_NAME)
datos$DATE_REV<-as.factor(datos$DATE_REV)
# ------------------------------------------------------------------------------
# check again
str(datos)
head(datos)
# ------------------------------------------------------------------------------
# convert survival time to decimal of minutes
datos$surv.time<-log10(datos$TIME_SURV_MIN+(datos$TIME_SURV_SEC/60))
datos$video.time<-log10(datos$VIDEO_DURATION_MIN+(datos$VIDEO_DURATION_SEC/60))
# ------------------------------------------------------------------------------
# Script to explore data and calculate survival times of DGRP lines
# ------------------------------------------------------------------------------
# Data generated by Félix P Leiva (e-mail: felixpleiva@gmail.com)
# Script created by Félix P Leiva (e-mail: felixpleiva@gmail.com)
# ------------------------------------------------------------------------------
# Cite as:
# Leiva FP, Santos M, Rezende E, & Verberk WCEP. (2022). Data and code of
# manuscript: Genetic variation on heat tolerance in a model ectotherm. Zenodo.
# (DOI is coming)
# ------------------------------------------------------------------------------
# Cleaning working space
rm(list=ls())
today<-format(Sys.Date(),"%Y%m%d")
# ------------------------------------------------------------------------------
# set the working directory to the folder containing this script:
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# ------------------------------------------------------------------------------
# check directory
getwd()
# ------------------------------------------------------------------------------
#Libraries
library(xlsx)
library(dplyr)
# ------------------------------------------------------------------------------
#read data of survival time
datos<-read.xlsx("../Data/TDT_DGRP_lines.xlsx", sheetName = "results on TDT available")
#Check data structure
str(datos)
# ------------------------------------------------------------------------------
# convert variables
datos$NUMBER_STOCK<-as.factor(datos$NUMBER_STOCK)
datos$FLASK_NUMBER<-as.factor(datos$FLASK_NUMBER)
datos$STRESS_TEMP<-as.numeric(datos$STRESS_TEMP)
datos$RUN_NUMBER<-as.factor(datos$RUN_NUMBER)
datos$DATE_REV<-as.factor(datos$DATE_REV)
datos$TIME_SURV_MIN<-as.numeric(datos$TIME_SURV_MIN)
datos$TIME_SURV_SEC<-as.numeric(datos$TIME_SURV_SEC)
datos$VIDEO_DURATION_MIN<-as.numeric(datos$VIDEO_DURATION_MIN)
datos$VIDEO_DURATION_SEC<-as.numeric(datos$VIDEO_DURATION_SEC)
datos$ACCLIM_TIME<-as.numeric(datos$ACCLIM_TIME)
datos$TEST_OXYGEN<-as.numeric(datos$TEST_OXYGEN)
datos$PLATE_NAME<-as.factor(datos$PLATE_NAME)
datos$WELL<-as.factor(datos$WELL)
datos$READER<-as.factor(datos$READER)
datos$GENOTYPE<-as.factor(datos$GENOTYPE)
datos$SEX<-as.factor(datos$SEX)
datos$VIDEO_NAME<-as.factor(datos$VIDEO_NAME)
datos$DATE_REV<-as.factor(datos$DATE_REV)
# ------------------------------------------------------------------------------
# check again
str(datos)
head(datos)
# ------------------------------------------------------------------------------
# convert survival time to decimal of minutes
datos$surv.time<-log10(datos$TIME_SURV_MIN+(datos$TIME_SURV_SEC/60))
datos$video.time<-log10(datos$VIDEO_DURATION_MIN+(datos$VIDEO_DURATION_SEC/60))
# ------------------------------------------------------------------------------
#Select only flies measured at 21 KPa
datos2<-filter(datos,TEST_OXYGEN==21)
#select columns of interest
names(datos2)
# ------------------------------------------------------------------------------
# Script to explore data and calculate survival times of DGRP lines
# ------------------------------------------------------------------------------
# Data generated by Félix P Leiva (e-mail: felixpleiva@gmail.com)
# Script created by Félix P Leiva (e-mail: felixpleiva@gmail.com)
# ------------------------------------------------------------------------------
# Cite as:
# Leiva FP, Santos M, Rezende E, & Verberk WCEP. (2022). Data and code of
# manuscript: Genetic variation on heat tolerance in a model ectotherm. Zenodo.
# (DOI is coming)
# ------------------------------------------------------------------------------
# Cleaning working space
rm(list=ls())
today<-format(Sys.Date(),"%Y%m%d")
# ------------------------------------------------------------------------------
# set the working directory to the folder containing this script:
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# ------------------------------------------------------------------------------
# check directory
getwd()
# ------------------------------------------------------------------------------
#Libraries
library(xlsx)
library(dplyr)
# ------------------------------------------------------------------------------
#read data of survival time
datos<-read.xlsx("../Data/TDT_DGRP_lines.xlsx", sheetName = "results on TDT available")
#Check data structure
str(datos)
# ------------------------------------------------------------------------------
# convert variables
datos$NUMBER_STOCK<-as.factor(datos$NUMBER_STOCK)
datos$FLASK_NUMBER<-as.factor(datos$FLASK_NUMBER)
datos$STRESS_TEMP<-as.numeric(datos$STRESS_TEMP)
datos$RUN_NUMBER<-as.factor(datos$RUN_NUMBER)
datos$DATE_REV<-as.factor(datos$DATE_REV)
datos$TIME_SURV_MIN<-as.numeric(datos$TIME_SURV_MIN)
datos$TIME_SURV_SEC<-as.numeric(datos$TIME_SURV_SEC)
datos$VIDEO_DURATION_MIN<-as.numeric(datos$VIDEO_DURATION_MIN)
datos$VIDEO_DURATION_SEC<-as.numeric(datos$VIDEO_DURATION_SEC)
datos$ACCLIM_TIME<-as.numeric(datos$ACCLIM_TIME)
datos$TEST_OXYGEN<-as.numeric(datos$TEST_OXYGEN)
datos$PLATE_NAME<-as.factor(datos$PLATE_NAME)
datos$WELL<-as.factor(datos$WELL)
datos$READER<-as.factor(datos$READER)
datos$GENOTYPE<-as.factor(datos$GENOTYPE)
datos$SEX<-as.factor(datos$SEX)
datos$VIDEO_NAME<-as.factor(datos$VIDEO_NAME)
datos$DATE_REV<-as.factor(datos$DATE_REV)
# ------------------------------------------------------------------------------
# check again
str(datos)
head(datos)
# ------------------------------------------------------------------------------
# convert survival time to decimal of minutes
datos$surv.time<-log10(datos$TIME_SURV_MIN+(datos$TIME_SURV_SEC/60))
datos$video.time<-log10(datos$VIDEO_DURATION_MIN+(datos$VIDEO_DURATION_SEC/60))
# ------------------------------------------------------------------------------
#Select only flies measured at 21 KPa
datos2<-filter(datos,TEST_OXYGEN==21)
#select columns of interest
names(datos2)
datos2<-datos[c(2:7,9,10,13,18:28)]
# ------------------------------------------------------------------------------
#Rename columns
names(datos2)
names(datos2)[c(1:20)] = c("video.name","stock","genotype","sex","test.temp","run","date.rev",
"id.ind","criteria","reader","acclim.temp","date.exp",
"age","test.oxygen","acclim.oxygen","acclim.time","plate.id","well.id","surv.time","video.time")
head(datos2)
# ------------------------------------------------------------------------------
#median per reader at 21 kPa
tdt<-aggregate(cbind(surv.time,video.time)~stock+genotype+
video.name+sex+test.temp+run+id.ind+acclim.temp+
date.exp+age+test.oxygen+acclim.oxygen+acclim.time,
data=datos2,median)
# ------------------------------------------------------------------------------
# Script to explore data and calculate survival times of DGRP lines
# ------------------------------------------------------------------------------
# Data generated by Félix P Leiva (e-mail: felixpleiva@gmail.com)
# Script created by Félix P Leiva (e-mail: felixpleiva@gmail.com)
# ------------------------------------------------------------------------------
# Cite as:
# Leiva FP, Santos M, Rezende E, & Verberk WCEP. (2022). Data and code of
# manuscript: Genetic variation on heat tolerance in a model ectotherm. Zenodo.
# (DOI is coming)
# ------------------------------------------------------------------------------
# Cleaning working space
rm(list=ls())
today<-format(Sys.Date(),"%Y%m%d")
# ------------------------------------------------------------------------------
# set the working directory to the folder containing this script:
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# ------------------------------------------------------------------------------
# check directory
getwd()
# ------------------------------------------------------------------------------
#Libraries
library(xlsx)
library(dplyr)
# ------------------------------------------------------------------------------
#read data of survival time
datos<-read.xlsx("../Data/TDT_DGRP_lines.xlsx", sheetName = "results on TDT available")
#Check data structure
str(datos)
# ------------------------------------------------------------------------------
# convert variables
datos$NUMBER_STOCK<-as.factor(datos$NUMBER_STOCK)
datos$FLASK_NUMBER<-as.factor(datos$FLASK_NUMBER)
datos$STRESS_TEMP<-as.numeric(datos$STRESS_TEMP)
datos$RUN_NUMBER<-as.factor(datos$RUN_NUMBER)
datos$DATE_REV<-as.factor(datos$DATE_REV)
datos$TIME_SURV_MIN<-as.numeric(datos$TIME_SURV_MIN)
datos$TIME_SURV_SEC<-as.numeric(datos$TIME_SURV_SEC)
datos$VIDEO_DURATION_MIN<-as.numeric(datos$VIDEO_DURATION_MIN)
datos$VIDEO_DURATION_SEC<-as.numeric(datos$VIDEO_DURATION_SEC)
datos$ACCLIM_TIME<-as.numeric(datos$ACCLIM_TIME)
datos$TEST_OXYGEN<-as.numeric(datos$TEST_OXYGEN)
datos$PLATE_NAME<-as.factor(datos$PLATE_NAME)
datos$WELL<-as.factor(datos$WELL)
datos$READER<-as.factor(datos$READER)
datos$GENOTYPE<-as.factor(datos$GENOTYPE)
datos$SEX<-as.factor(datos$SEX)
datos$VIDEO_NAME<-as.factor(datos$VIDEO_NAME)
datos$DATE_REV<-as.factor(datos$DATE_REV)
# ------------------------------------------------------------------------------
# check again
str(datos)
head(datos)
# ------------------------------------------------------------------------------
# convert survival time to decimal of minutes
datos$surv.time<-log10(datos$TIME_SURV_MIN+(datos$TIME_SURV_SEC/60))
datos$video.time<-log10(datos$VIDEO_DURATION_MIN+(datos$VIDEO_DURATION_SEC/60))
# ------------------------------------------------------------------------------
#Select only flies measured at 21 KPa
datos<-filter(datos,TEST_OXYGEN==21)
#select columns of interest
names(datos)
datos2<-datos[c(2:7,9,10,13,18:28)]
# ------------------------------------------------------------------------------
#Rename columns
names(datos2)
names(datos2)[c(1:20)] = c("video.name","stock","genotype","sex","test.temp","run","date.rev",
"id.ind","criteria","reader","acclim.temp","date.exp",
"age","test.oxygen","acclim.oxygen","acclim.time","plate.id","well.id","surv.time","video.time")
head(datos2)
# ------------------------------------------------------------------------------
#median per reader at 21 kPa
tdt<-aggregate(cbind(surv.time,video.time)~stock+genotype+
video.name+sex+test.temp+run+id.ind+acclim.temp+
date.exp+age+test.oxygen+acclim.oxygen+acclim.time,
data=datos2,median)
#-------------------------------------------------------------------------------
# Transform variables wrongly assigned
str(tdt)
tdt$date.exp<-as.factor(tdt$date.exp)
# ------------------------------------------------------------------------------
#export data frames for future analyses
write.csv(tdt, "../Outputs/0.1.1. Survival time of Drosophila melanogaster across DGRP lines.csv",row.names=FALSE)
#-------------------------------------------------------------------------------
#saving session information with all package' versions for reproducibility
#purposes
sink("../Outputs/0.1.3. Exploratory_analysis_TDT_R_session.txt")
sessionInfo()
sink()
# ------------------------------------------------------------------------------
#export data frames for future analyses
write.csv(tdt, "../Outputs/0.1.1. Survival time of Drosophila melanogaster across DGRP lines.csv",row.names=FALSE)
#-------------------------------------------------------------------------------
#saving session information with all package' versions for reproducibility
#purposes
sink("../Outputs/0.1.2. Exploratory_analysis_TDT_R_session.txt")
sessionInfo()
sink()
